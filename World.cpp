#include "World.h"

World::World() : DOWN_MAX(32 * 16)
{
    TATE = 20;
    YOKO = 38;
	int temp[20][38] = {
		{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
		{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,0,0,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
		{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
		{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
		{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
		{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	};
	
	for(int tate = 0; tate < TATE; tate++) {
		for(int yoko = 0; yoko < YOKO; yoko++) {
			map[tate][yoko] = temp[tate][yoko];
		}
	}

	for (int y = 0; y <= TATE; y++) {
		for (int x = 0; x <= YOKO; x++) {
			if (map[y][x] == 1) box.push_back(new Soil(x, y));
		}
	}
}

void World::Draw()
{
	for (it = box.begin(); it != box.end(); it++)
		(*it)->Draw();
}

int World::Set(Point p)
{
	 int tempx[2]; 
	 int tempy = (int)p.y / 32;
	 int yy = DOWN_MAX / 32;
	 int yuka = DOWN_MAX;
	 int i = tempy;

	 tempx[0] = (int)(p.x + 5) / 32;
	 tempx[1] = (int)(p.x + 28) / 32;

	 if (map[tempy][tempx[0]] == 0 || map[tempy][tempx[1]] == 0)
	 {
		 while (i < DOWN_MAX / 32)
		 {
			 i++;
			 if (map[i][tempx[0]] == 1 || map[tempy][tempx[0]] == 1)
			 {
				 yy = i;
				 break;
			 }
		 }

		 yuka = yy * 32;
	 }

	 return yuka;
}
//World w;
//Map* map;
//map = w.Set();
//int tempx = (int)p.x / 32;
//int tempy = (int)p.y / 32;
//int yy = DOWN_MAX / 32;
//int i;
//
//if (map->map[tempy][tempx] == 0)
//{
//	for (int i = tempy; i < DOWN_MAX / 32; i++)
//	{
//		if (map->map[i][tempx] == 1)
//		{
//			yy = i;
//			break;
//		}
//	}
//
//	yuka = yy * 32;
//}

//if (map->map[tempy ][tempx] == 0)
//{
//	DrawFormatString(0, 0, GetColor(255, 255, 255), "”{—¦ %d    %d", tempx,tempy);
//	DrawBox(tempx * 32, (tempy+1)*32, tempx*32+32, (tempy+1)*32+32, GetColor(255,100,255), true);
//	yuka = (tempy + 1) * 32;
//}

//if (map->map[tempy ][tempx] == 0)
//{
//	DrawFormatString(0, 0, GetColor(255, 255, 255), "”{—¦ %d    %d", tempx,tempy);
//	DrawBox(tempx * 32, (tempy+1)*32, tempx*32+32, (tempy+1)*32+32, GetColor(255,100,255), true);
//	yuka = (tempy + 1) * 32;
//}

